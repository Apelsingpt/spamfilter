<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spam Detector AI</title>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0"></script>

<style>
body {
    font-family: Arial;
    background:#111;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.card {
    background:#222;
    padding:25px;
    border-radius:12px;
    width:400px;
    text-align:center;
}

textarea {
    width:100%;
    height:120px;
    border-radius:8px;
    border:none;
    padding:10px;
    font-size:16px;
}

button {
    margin-top:15px;
    padding:10px 20px;
    font-size:18px;
    background:#00ffaa;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

#result {
    margin-top:15px;
    font-size:22px;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="card">
    <h1>ðŸ“§ Spam Detector AI</h1>

    <textarea id="textInput" placeholder="Paste English email text..."></textarea>

    <button onclick="predict()">Check</button>

    <div id="result"></div>
</div>

<script>
let model;
let wordIndex;

const MAXLEN = 30;

// Load model + tokenizer
async function loadAll() {
    document.getElementById("result").innerText = "Loading model...";

    model = await tf.loadLayersModel("model.json");

    const response = await fetch("word_index.json");
    wordIndex = await response.json();

    document.getElementById("result").innerText = "Model loaded âœ…";
}

loadAll();

// Simple tokenizer
function tokenize(text) {
    text = text.toLowerCase().replace(/[^a-z\s]/g,"");
    let words = text.split(" ");

    let tokens = [];

    for (let w of words) {
        tokens.push(wordIndex[w] || 0);
    }

    // padding
    if (tokens.length > MAXLEN)
        tokens = tokens.slice(0,MAXLEN);

    while (tokens.length < MAXLEN)
        tokens.push(0);

    return tokens;
}

// Predict
async function predict() {

    const text = document.getElementById("textInput").value;

    if (!text) return;

    const tokens = tokenize(text);

    const input = tf.tensor2d([tokens],[1,MAXLEN]);

    const pred = model.predict(input);
    const score = (await pred.data())[0];

    let resultText = "";

    if (score > 0.5) {
        resultText = `ðŸš¨ SPAM (${(score*100).toFixed(1)}%)`;
    } else {
        resultText = `âœ… NOT SPAM (${((1-score)*100).toFixed(1)}%)`;
    }

    document.getElementById("result").innerText = resultText;

    input.dispose();
    pred.dispose();
}
</script>

</body>
</html>
